Gu√≠a Completa: Adaptar el Sistema RAG a Procesal Civil
üöÄ PASO 1: Instalaci√≥n Inicial
1.1 Instalar dependencias
Primero necesitas crear un archivo requirements.txt:

# Crear requirements.txt
cat > requirements.txt << 'EOF'
langchain-google-genai>=0.1.0
langchain-chroma>=0.1.0
langchain-huggingface>=0.0.1
langchain-core>=0.2.0
streamlit>=1.30.0
pdfplumber>=0.10.0
reportlab>=4.0.0
tqdm>=4.65.0
langdetect>=1.0.9
chromadb>=0.4.0
sentence-transformers>=2.2.0
EOF

# Instalar
pip install -r requirements.txt
1.2 Configurar API Key de Gemini
# Opci√≥n 1: Variable de entorno temporal
export GOOGLE_API_KEY="tu_clave_de_google_gemini_aqui"

# Opci√≥n 2: Archivo .env (recomendado)
cat > .env << 'EOF'
GOOGLE_API_KEY=tu_clave_de_google_gemini_aqui
EOF

# Agregar .env al gitignore
echo ".env" >> .gitignore
Para obtener tu API key: https://makersuite.google.com/app/apikey

‚öôÔ∏è PASO 2: Configurar Bases RAG para Procesal Civil
2.1 Editar config.py
Abre config.py y modifica la secci√≥n de bases RAG (alrededor de la l√≠nea 50):

# ======================
# BASES RAG DISPONIBLES
# ======================

BASES_RAG: Dict[str, str] = {
    # Bases de Procesal Civil
    "Procesal Civil - Doctrina": "pdfs_procesal_doctrina",
    "Procesal Civil - Jurisprudencia": "pdfs_procesal_jurisp",
    "Procesal Civil - Normativa": "pdfs_procesal_normativa",
    "Procesal Civil - Formularios": "pdfs_procesal_formularios",
    
    # Opcional: mantener las bases originales si las necesitas
    # "Salud - M√©dica": "pdfs_salud_medica",
    # "Salud - Laboral": "pdfs_salud_laboral",
}
2.2 Actualizar Keywords (l√≠nea 204)
# ======================
# KEYWORDS PROCESAL CIVIL
# ======================

KEYWORDS_JURIDICO_SANIT = (
    # Keywords procesales
    "art√≠culo", "articulo", "considerando", "resuelve", "sentencia", "fallo",
    "tribunal", "c√°mara", "juzgado", "demanda", "reconvenci√≥n", "contestaci√≥n",
    "prueba", "pericial", "testimonial", "documental", "informativa",
    
    # Conceptos procesales clave
    "competencia", "jurisdicci√≥n", "admisibilidad", "legitimaci√≥n",
    "carga probatoria", "carga de la prueba", "valoraci√≥n probatoria",
    "medida cautelar", "embargo", "inhibici√≥n", "anotaci√≥n de litis",
    "excepci√≥n", "nulidad", "caducidad", "prescripci√≥n",
    "recurso", "apelaci√≥n", "casaci√≥n", "queja", "aclaratoria",
    "cosa juzgada", "litispendencia", "ejecutoria",
    
    # Actos procesales
    "traslado", "vista", "alegatos", "llamamiento de autos",
    "notificaci√≥n", "c√©dula", "oficio", "exhorto",
    "audiencia", "vista de causa", "alegato",
    
    # C√≥digos relevantes
    "CPCCN", "CPCC", "C√≥digo Procesal"
)
üìù PASO 3: Personalizar el Prompt de An√°lisis
3.1 Crear prompt espec√≠fico para procesal civil
# Crear nuevo archivo de prompt
cat > prompts/analisis_procesal_civil.md << 'EOF'
[Contexto recuperado con metadatos y referencias]
{contexto}

[Texto o consulta principal]
{texto}

[INSTRUCCIONES DE AN√ÅLISIS PROCESAL CIVIL]

1Ô∏è‚É£ **S√≠ntesis contextual**
   - Identifica el tipo de proceso (conocimiento, ejecuci√≥n, cautelar, etc.)
   - Determina la etapa procesal actual (demanda, prueba, alegatos, sentencia, recurso)
   - Identifica las partes y sus roles procesales
   - Reconoce fuentes aplicables (CPCCN, c√≥digos provinciales, jurisprudencia)

2Ô∏è‚É£ **Ejes procesales clave**
   Analiza en profundidad los siguientes aspectos seg√∫n corresponda:
   
   **a) Competencia y Admisibilidad**
   - Competencia material, territorial, funcional
   - Requisitos formales de admisibilidad
   - Legitimaci√≥n activa y pasiva
   
   **b) Prueba**
   - Carga probatoria de cada parte
   - Admisibilidad y pertinencia de las pruebas
   - Valoraci√≥n probatoria seg√∫n el sistema legal
   - Pruebas producidas vs. pruebas pendientes
   
   **c) Plazos y Preclusi√≥n**
   - Plazos procesales aplicables
   - Actos procesales realizados en t√©rmino
   - Efectos de la preclusi√≥n
   
   **d) Recursos**
   - Recursos disponibles seg√∫n la etapa
   - Requisitos de admisibilidad del recurso
   - Plazo, forma y efectos
   
   **e) Medidas Cautelares**
   - Requisitos: verosimilitud del derecho y peligro en la demora
   - Contracautela exigible
   - Procedimiento de obtenci√≥n

3Ô∏è‚É£ **Evaluaci√≥n estrat√©gica**
   - **Fortalezas procesales**: Argumentos s√≥lidos, pruebas contundentes
   - **Debilidades**: Defectos formales, insuficiencia probatoria, preclusiones
   - **Riesgos**: Prescripci√≥n, caducidad, costas
   - **Contradicciones jurisprudenciales**: Corrientes encontradas sobre el tema

4Ô∏è‚É£ **Jurisprudencia aplicable**
   - Cita fallos relevantes con formato:
     "Tribunal ‚Äì Car√°tula (A√±o), [Jurisdicci√≥n]"
   - Distingue entre jurisprudencia plenaria, mayoritaria y minoritaria
   - Identifica tendencias actuales de los tribunales

5Ô∏è‚É£ **Normativa aplicable**
   - Art√≠culos espec√≠ficos del CPCCN o c√≥digo provincial
   - Legislaci√≥n de fondo aplicable (CCyCN, leyes especiales)
   - Acordadas y resoluciones relevantes

6Ô∏è‚É£ **Estrategia procesal recomendada**
   - Pr√≥ximos pasos procesales sugeridos
   - Actos procesales cr√≠ticos a no omitir
   - Alternativas disponibles (mediaci√≥n, transacci√≥n, etc.)

7Ô∏è‚É£ **Preguntas derivadas**
   - Formula 3-5 preguntas que profundicen el an√°lisis
   - Indica qu√© informaci√≥n adicional ser√≠a necesaria (documentos, pericias, etc.)

8Ô∏è‚É£ **Conclusi√≥n procesal**
   - Probabilidad de √©xito (baja/media/alta) con fundamentaci√≥n
   - Estimaci√≥n de tiempos procesales
   - Costos estimados del proceso

[FORMATO DE SALIDA]

Primero entrega un **informe narrativo completo** con estas secciones:
üîπ Resumen del caso y etapa procesal
üîπ An√°lisis de competencia y admisibilidad
üîπ An√°lisis probatorio
üîπ Plazos y preclusiones relevantes
üîπ Jurisprudencia y normativa aplicable
üîπ Fortalezas y debilidades procesales
üîπ Estrategia procesal recomendada
üîπ Preguntas de profundizaci√≥n
üîπ Conclusi√≥n: probabilidad de √©xito y pr√≥ximos pasos

Luego, entrega un **bloque JSON resumido**:

{
  "tipo_proceso": "conocimiento|ejecuci√≥n|cautelar|...",
  "etapa_procesal": "demanda|prueba|alegatos|sentencia|recurso|...",
  "tesis": "...",
  "conceptos_clave": ["competencia", "carga probatoria", "..."],
  "fortalezas": ["..."],
  "debilidades": ["..."],
  "preguntas": ["..."],
  "probabilidad_exito": "baja|media|alta",
  "jurisprudencia_relevante": [
    {"tribunal": "...", "caratula": "...", "anio": "...", "jurisdiccion": "..."}
  ],
  "normativa_aplicable": [
    {"norma": "CPCCN", "articulos": ["...", "..."]},
    {"norma": "CCyCN", "articulos": ["..."]}
  ],
  "proximos_pasos": ["...", "..."],
  "plazo_estimado_meses": 12
}
EOF
3.2 Configurar para usar el nuevo prompt
# Opci√≥n 1: Variable de entorno
export ANALYSIS_PROMPT_FILE="./prompts/analisis_procesal_civil.md"

# Opci√≥n 2: Agregarlo al .env
echo 'ANALYSIS_PROMPT_FILE=./prompts/analisis_procesal_civil.md' >> .env
üìö PASO 4: Preparar e Ingestar Documentos
4.1 Organizar tus PDFs
Crea una estructura de carpetas:

mkdir -p pdfs/procesal_civil/{doctrina,jurisprudencia,normativa,formularios}
Coloca tus documentos:

pdfs/procesal_civil/doctrina/ ‚Üí Libros, art√≠culos doctrinarios
pdfs/procesal_civil/jurisprudencia/ ‚Üí Sentencias, fallos
pdfs/procesal_civil/normativa/ ‚Üí CPCCN, c√≥digos provinciales, leyes
pdfs/procesal_civil/formularios/ ‚Üí Modelos de escritos
4.2 Ingestar documentos individualmente
# Ingestar un PDF de doctrina
python ingesta.py \
  --pdf ./pdfs/procesal_civil/doctrina/palacio_derecho_procesal_civil.pdf \
  --base "Procesal Civil - Doctrina"

# Ingestar jurisprudencia
python ingesta.py \
  --pdf ./pdfs/procesal_civil/jurisprudencia/fallo_csjn_2023.pdf \
  --base "Procesal Civil - Jurisprudencia"

# Ingestar normativa
python ingesta.py \
  --pdf ./pdfs/procesal_civil/normativa/cpccn.pdf \
  --base "Procesal Civil - Normativa"
4.3 Ingesta masiva (recomendado)
# Doctrina
export BASE_RAG="Procesal Civil - Doctrina"
export PDF_DIR="./pdfs/procesal_civil/doctrina"
python ingesta_batch.py

# Jurisprudencia
export BASE_RAG="Procesal Civil - Jurisprudencia"
export PDF_DIR="./pdfs/procesal_civil/jurisprudencia"
python ingesta_batch.py

# Normativa
export BASE_RAG="Procesal Civil - Normativa"
export PDF_DIR="./pdfs/procesal_civil/normativa"
python ingesta_batch.py
üîç PASO 5: Usar el Sistema
5.1 Interfaz Web (Recomendado para usuarios no t√©cnicos)
streamlit run app_streamlit_salud.py
Abre tu navegador en http://localhost:8501

Funcionalidades disponibles:

üì§ Subir PDF de un escrito, demanda o sentencia
üí¨ Hacer consultas procesales ("¬øQu√© recurso procede contra...?")
üìä Ver an√°lisis con probabilidad de √©xito
üíæ Guardar an√°lisis en historial
üì• Exportar reportes a PDF
üîÑ Seleccionar qu√© bases RAG consultar
5.2 L√≠nea de Comandos
# Analizar un PDF (demanda, sentencia, escrito)
python analyser.py \
  --pdf ./casos/demanda_da√±os_perjuicios.pdf \
  --out reporte_analisis.pdf

# Hacer una consulta espec√≠fica
python analyser.py \
  --query "¬øCu√°l es el plazo para apelar una sentencia definitiva en primera instancia seg√∫n el CPCCN?" \
  --out respuesta_recurso.pdf

# Analizar un caso complejo
python analyser.py \
  --query "Analiza la competencia en un caso de da√±os y perjuicios por accidente de tr√°nsito donde el actor tiene domicilio en CABA y el demandado en Provincia de Buenos Aires. El accidente ocurri√≥ en C√≥rdoba." \
  --out analisis_competencia.pdf
üõ†Ô∏è PASO 6: Herramientas de Auditor√≠a y Mantenimiento
6.1 Verificar bases creadas
# Listar todas las bases y versiones
python audit_bases.py --list

# Ver estad√≠sticas generales
python audit_bases.py --stats
6.2 Auditar calidad de una base
# Auditar base de jurisprudencia
python audit_bases.py --audit "Procesal Civil - Jurisprudencia"

# Resultado esperado:
# ‚úì Total documentos: 150
# ‚úì Total fragmentos: 4521
# ‚úì Calidad promedio: 3.8/5.0
# ‚úì Diversidad l√©xica: 0.42
6.3 Comparar versiones
# Si migraste de un modelo de embeddings a otro
python audit_bases.py --compare "Procesal Civil - Doctrina" "1.0.0" "2.0.0"
üí° EJEMPLOS DE USO PR√ÅCTICOS
Ejemplo 1: Analizar una demanda
python analyser.py \
  --pdf ./casos/demanda_cumplimiento_contrato.pdf \
  --out analisis_demanda.pdf
El sistema devolver√°:

Identificaci√≥n de partes y pretensiones
An√°lisis de competencia
Evaluaci√≥n de pruebas ofrecidas
Carga probatoria de cada parte
Jurisprudencia aplicable
Probabilidad de √©xito
Defensas posibles del demandado
Ejemplo 2: Consulta sobre recursos
python analyser.py \
  --query "Analiza si procede recurso de apelaci√≥n contra un auto que rechaza una medida cautelar de embargo preventivo. Fundamenta con jurisprudencia." \
  --out recurso_cautelar.pdf
Ejemplo 3: Estrategia procesal
python analyser.py \
  --query "Tengo una sentencia adversa en primera instancia por da√±os y perjuicios. El juez valor√≥ negativamente la prueba pericial. ¬øQu√© estrategia procesal recomend√°s para el recurso de apelaci√≥n?" \
  --out estrategia_apelacion.pdf
Ejemplo 4: Investigaci√≥n jurisprudencial
python analyser.py \
  --query "Recopila jurisprudencia de la CSJN sobre carga probatoria en casos de responsabilidad del Estado por falta de servicio entre 2015-2024" \
  --out jurisp_falta_servicio.pdf
üéØ CASOS DE USO POR ROL
Para Abogados Litigantes:
Analizar escritos de demanda antes de presentar
Verificar admisibilidad de recursos
Buscar jurisprudencia actualizada sobre temas espec√≠ficos
Evaluar probabilidad de √©xito de una estrategia procesal
Para Estudiantes:
Consultar conceptos procesales con fuentes
Analizar casos de estudio
Preparar trabajos pr√°cticos con fundamentaci√≥n jurisprudencial
Entender plazos y etapas procesales
Para Procuradores:
Verificar plazos y vencimientos
Controlar requisitos formales de escritos
Validar notificaciones y c√©dulas
Consultar formularios y modelos
Para Investigadores:
An√°lisis comparado de jurisprudencia
Tendencias en interpretaci√≥n normativa
Estudios de l√≠neas jurisprudenciales
Identificaci√≥n de contradicciones entre tribunales
‚öôÔ∏è CONFIGURACI√ìN AVANZADA
Ajustar par√°metros de b√∫squeda (config.py l√≠nea 188)
@dataclass
class AnalysisConfig:
    k_por_base: int = 8              # M√°s fragmentos = m√°s contexto (5-10)
    fetch_k: int = 50                # M√°s candidatos = mejor ranking (32-100)
    max_context_length: int = 12000  # M√°s contexto para casos complejos
    
    # Re-scoring
    enable_rescoring: bool = True    # Mejora precisi√≥n
    keyword_bonus_max: float = 0.25  # Bonus por keywords procesales
Cambiar modelo LLM (config.py l√≠nea 61)
DEFAULT_LLM = "gemini-2.5-pro"        # M√°s preciso pero m√°s lento
# DEFAULT_LLM = "gemini-1.5-flash"   # M√°s r√°pido pero menos preciso
DEFAULT_TEMPERATURE = 0.1            # M√°s bajo = m√°s determin√≠stico (0.0-0.5)
Mejorar extracci√≥n de metadata (config.py l√≠nea 174)
detect_language: bool = True           # Detectar idioma
extract_author: bool = True            # Extraer autor/tribunal
extract_title: bool = True             # Extraer car√°tula
extract_year: bool = True              # Extraer a√±o del fallo
extract_jurisdiction: bool = True      # Extraer jurisdicci√≥n
use_llm_metadata: bool = True          # Usar Gemini (m√°s preciso pero lento)
üìä MONITOREO Y OPTIMIZACI√ìN
Ver historial de an√°lisis
En la interfaz Streamlit:

Ir a secci√≥n "üóÇÔ∏è Historial de an√°lisis anteriores"
Ver todos los an√°lisis guardados con timestamp
Exportar o descargar PDFs originales
Limpiar historial antiguo
# En Streamlit: secci√≥n "‚ÑπÔ∏è Informaci√≥n del sistema"
# Click en "üßπ Limpiar archivos >30 d√≠as"
Gestionar versiones de bases
# Listar versiones de una base
python audit_bases.py --audit "Procesal Civil - Doctrina"

# Activar versi√≥n espec√≠fica
python audit_bases.py --activate "Procesal Civil - Doctrina" "1.0.0"

# Migrar a mejor modelo de embeddings
python migrate_cli.py \
  --base "Procesal Civil - Doctrina" \
  --model sentence-transformers/paraphrase-multilingual-mpnet-base-v2
‚ùì SOLUCI√ìN DE PROBLEMAS COMUNES
"No module named 'langchain_huggingface'"
pip install langchain-huggingface sentence-transformers
"GOOGLE_API_KEY not found"
export GOOGLE_API_KEY="tu_clave_aqui"
# O agregarlo a .env
"Base no encontrada"
# Verifica que el nombre coincida exactamente con config.py
python audit_bases.py --list
Resultados poco relevantes
# 1. Aumentar k_por_base en config.py
# 2. Verificar calidad de la base
python audit_bases.py --audit "Tu Base"
# 3. Re-ingestar con mejor configuraci√≥n
üöÄ PR√ìXIMOS PASOS RECOMENDADOS
Ingestar corpus inicial (50-200 documentos por base m√≠nimo)
Probar con casos reales y validar precisi√≥n
Ajustar prompts seg√∫n los resultados obtenidos
Crear bases especializadas (ej: "Procesal Civil - Ejecuci√≥n Fiscal")
Documentar casos de uso exitosos para tu equipo
¬øNecesitas ayuda con alg√∫n paso espec√≠fico? Puedo asistirte con:

Crear el archivo de prompt personalizado
Configurar las bases RAG
Adaptar keywords espec√≠ficos de tu jurisdicci√≥n
Optimizar par√°metros para tu tipo de documentos
claude/verify-code-errors-011CUc4HU2KuGvtZwEe6LfVf

